{
  "kind": "build_request",
  "title": "Restore public catalog visibility and enable targeted availability re-enable for a specific uploaded book",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Add an admin-only backend method that sets `available=true` for books matching an admin-provided identifier (exact title/filename text match, case-insensitive), and returns a result containing (a) the number of books updated and (b) the list of updated book IDs/titles. The identifier to support immediately is: \"CRYPTO BEGINNER'S GUIDE: HOW TO BUY GOLD TOKENS / GLDT AND MORE FROM SCRATCH\".",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-2"
        ],
        "quotes": [
          "Here's the exact file name of one of them;",
          "CRYPTO BEGINNER'S GUIDE: HOW TO BUY GOLD TOKENS / GLDT AND MORE FROM SCRATCH"
        ]
      },
      "acceptanceCriteria": [
        "When called by an admin with the provided identifier, at least one matching book (if present in `bookStore`) is updated to `available=true` and the response includes the updated book(s) metadata (IDs/titles).",
        "If no book matches the identifier, the method returns a result indicating 0 updates (and does not trap), so the admin can see it did not find the book.",
        "The method traps with an authorization error if the caller is not an admin."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Ensure the backend re-enable-by-identifier operation does not re-list sold-out single-copy books: if a matching book has `singleCopy=true` and there is evidence it has already been sold (ownership/purchase record exists for that book), keep `available=false` for that book and report it as skipped in the returned result.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-3"
        ],
        "quotes": [
          "NOTHING YET ON THE PUBLIC SITE"
        ]
      },
      "acceptanceCriteria": [
        "For matching books that are sold-out single-copy items, the operation leaves `available=false`.",
        "The returned result distinguishes updated vs skipped (sold-out) matches so the admin can understand what happened."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Add an Admin Settings UI section that lets an admin paste a book identifier (title/filename text) and run the new backend re-enable-by-identifier operation, showing a clear success/failure summary and the list of updated/skipped matches.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-2"
        ],
        "quotes": [
          "Here's the exact file name of one of them;",
          "CRYPTO BEGINNER'S GUIDE: HOW TO BUY GOLD TOKENS / GLDT AND MORE FROM SCRATCH"
        ]
      },
      "acceptanceCriteria": [
        "Admin can paste the identifier text and click a button to run the operation.",
        "On success, the UI displays counts and the matched book IDs/titles that were updated and those skipped (if any).",
        "On failure, the UI shows an error message in English without crashing."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Fix public catalog visibility by making the public-facing catalog page query only available books (use `getAvailableBooks` via the existing React Query hook), so books marked `available=true` are what appear on the public site.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-3"
        ],
        "quotes": [
          "NOTHING YET ON THE PUBLIC SITE"
        ]
      },
      "acceptanceCriteria": [
        "Catalog page uses the available-books query (not the all-books query) for the public browsing experience.",
        "After running re-enable for a book that becomes `available=true`, refreshing the public catalog shows that book in the list."
      ]
    },
    {
      "id": "REQ-5",
      "text": "Apply a consistent visual theme for the new admin settings controls (spacing, typography, button hierarchy, alerts) that matches the existing admin settings page styling and keeps user-facing text in English.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Use English for any user-facing text in the build request."
        ]
      },
      "acceptanceCriteria": [
        "New UI elements visually match existing Admin Settings cards/alerts/buttons (no inconsistent styling).",
        "All new labels, helper text, and messages are in English."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor in backend/main.mo (no additional backend services).",
    "Do not edit files under frontend/src/components/ui or other immutable frontend paths listed in SYSTEM_CONTEXT; compose existing UI components instead."
  ],
  "nonGoals": [
    "Recovering missing Live/public data that does not exist in the canister state (e.g., restoring a book that was never imported) is out of scope for this change.",
    "Implementing third-party authentication or any external database/storage beyond the existing canister state is out of scope."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}